<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Petualangan Matematika Ceria</title>
    <!-- Tailwind CSS CDN untuk styling yang cepat dan responsif -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Poppins untuk tampilan yang ceria -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
        }
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>
<body class="bg-yellow-100 flex items-center justify-center min-h-screen p-4">

    <!-- Kontainer Utama Aplikasi -->
    <div class="bg-white rounded-3xl shadow-2xl p-6 md:p-12 w-full max-w-2xl text-center border-4 border-green-600">
        
        <!-- Header Aplikasi -->
        <h1 class="text-4xl md:text-5xl font-extrabold text-green-700 mb-2">Petualangan Matematika</h1>
        <p class="text-lg md:text-xl text-gray-600 mb-8">Bantu Momo si Kambing Cerdas selesaikan misinya!</p>

        <!-- Area Game -->
        <div class="relative bg-lime-100 rounded-2xl p-6 mb-8 border-2 border-lime-500">
            <!-- Display Karakter -->
            <div class="flex flex-col items-center">
                <img id="momo-character" src="https://placehold.co/150x150/d4ed6b/588157?text=Momo" alt="Momo si Kambing Cerdas" class="w-24 h-24 md:w-32 md:h-32 mb-4 transform transition-transform duration-300">
                <p id="question-text" class="text-3xl md:text-4xl font-bold text-gray-800 my-4"></p>
            </div>

            <!-- Input Jawaban dan Tombol -->
            <div class="flex justify-center items-center space-x-4 mt-6">
                <input type="number" id="answer-input" class="w-24 md:w-32 p-3 text-center rounded-xl text-xl font-bold border-2 border-gray-300 focus:outline-none focus:ring-4 focus:ring-green-400 transition-all duration-200" placeholder="?">
                <button id="submit-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transform transition-all duration-200 hover:scale-105">
                    Cek
                </button>
            </div>

            <!-- Area Feedback dan Info Skor -->
            <p id="feedback-message" class="mt-4 text-xl md:text-2xl font-semibold opacity-0 transition-opacity duration-300"></p>
            <div class="flex justify-between items-center text-sm md:text-base font-bold mt-6 text-gray-700">
                <span>Skor: <span id="score">0</span></span>
                <span>Level: <span id="level">1</span></span>
            </div>
        </div>
        
        <!-- Area Koleksi Hewan -->
        <div class="bg-gray-100 rounded-2xl p-6 border-2 border-gray-300">
            <h2 class="text-2xl font-bold text-gray-700 mb-4">Koleksi Hewan di AFIA FARM</h2>
            <div id="animal-collection" class="grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 lg:grid-cols-8 gap-4 justify-items-center">
                <!-- Hewan akan ditambahkan di sini oleh JavaScript -->
            </div>
            <p id="collection-message" class="mt-4 text-green-700 font-semibold text-lg opacity-0 transition-opacity duration-300"></p>
        </div>
    </div>

    <!-- Script JavaScript untuk Logika Game -->
    <script>
        // Menginisialisasi variabel game
        let score = 0;
        let level = 1;
        let currentProblem = {};
        const MAX_NUMBER = 100;
        const COLLECTION_MILESTONE = 5; // Dapatkan hewan baru setiap 5 jawaban benar

        // Daftar hewan yang bisa dikoleksi
        const animalList = [
            { name: "Sapi", emoji: "üêÑ", unlocked: false },
            { name: "Domba", emoji: "üêë", unlocked: false },
            { name: "Ayam", emoji: "üêî", unlocked: false },
            { name: "Bebek", emoji: "ü¶Ü", unlocked: false },
            { name: "Kelinci", emoji: "üêá", unlocked: false },
            { name: "Kuda", emoji: "üêé", unlocked: false },
            { name: "Babi", emoji: "üêñ", unlocked: false },
            { name: "Kucing", emoji: "üêà", unlocked: false },
        ];
        let collectedAnimals = [];
        
        // Mengambil elemen-elemen DOM
        const questionText = document.getElementById('question-text');
        const answerInput = document.getElementById('answer-input');
        const submitBtn = document.getElementById('submit-btn');
        const feedbackMessage = document.getElementById('feedback-message');
        const scoreElement = document.getElementById('score');
        const levelElement = document.getElementById('level');
        const momoCharacter = document.getElementById('momo-character');
        const animalCollectionDiv = document.getElementById('animal-collection');
        const collectionMessage = document.getElementById('collection-message');

        /**
         * Mengatur ulang UI dan memulai masalah matematika baru.
         */
        function generateProblem() {
            let operation, num1, num2, answer;
            const operations = ['+', '-'];
            
            // Tambahkan perkalian dan pembagian saat level mencapai 4
            if (level >= 4) {
                operations.push('*', '/');
            }

            // Pilih operasi secara acak dari array operations
            operation = operations[Math.floor(Math.random() * operations.length)];

            if (operation === '+') {
                num1 = Math.floor(Math.random() * (MAX_NUMBER / 2)) + 1;
                num2 = Math.floor(Math.random() * (MAX_NUMBER / 2)) + 1;
                answer = num1 + num2;
            } else if (operation === '-') {
                num1 = Math.floor(Math.random() * MAX_NUMBER) + 1;
                num2 = Math.floor(Math.random() * num1) + 1;
                answer = num1 - num2;
            } else if (operation === '*') {
                // Batasi angka untuk perkalian agar tidak terlalu sulit
                num1 = Math.floor(Math.random() * 9) + 1;
                num2 = Math.floor(Math.random() * 9) + 1;
                answer = num1 * num2;
            } else if (operation === '/') {
                // Pastikan hasil pembagian adalah bilangan bulat
                num2 = Math.floor(Math.random() * 9) + 2; // Mulai dari 2 agar tidak dibagi 1
                answer = Math.floor(Math.random() * 9) + 1;
                num1 = num2 * answer;
            }

            // Menyimpan masalah saat ini dan menampilkannya di UI
            currentProblem = { num1, num2, operation, answer };
            questionText.textContent = `Berapa ${num1} ${operation} ${num2}?`;
            answerInput.value = '';
            feedbackMessage.textContent = '';
            feedbackMessage.classList.remove('opacity-100', 'text-green-500', 'text-red-500');
            momoCharacter.style.transform = 'scale(1)';
        }

        /**
         * Memeriksa jawaban yang dimasukkan oleh pengguna.
         */
        function checkAnswer() {
            const userAnswer = parseInt(answerInput.value, 10);
            
            if (isNaN(userAnswer)) {
                showFeedback("Masukkan angka, ya!", "text-red-500");
                return;
            }

            if (userAnswer === currentProblem.answer) {
                // Jawaban benar
                score++;
                if (score % 5 === 0) {
                    level++;
                    showFeedback("üéâ Selamat! Levelmu naik!", "text-green-500");
                    collectNewAnimal(); // Panggil fungsi untuk mengumpulkan hewan baru
                } else {
                    showFeedback("Jawabanmu benar! üëç", "text-green-500");
                    momoCharacter.style.transform = 'scale(1.1) rotate(10deg)';
                }
                updateUI();
                setTimeout(generateProblem, 1500);
            } else {
                // Jawaban salah
                showFeedback("Oops, salah. Coba lagi! üò•", "text-red-500");
            }
        }

        /**
         * Mengumpulkan hewan baru dan memperbarui tampilan koleksi.
         */
        function collectNewAnimal() {
            const unlockedAnimal = animalList.find(animal => !animal.unlocked);
            if (unlockedAnimal) {
                unlockedAnimal.unlocked = true;
                collectedAnimals.push(unlockedAnimal);
                updateCollectionDisplay();
                showCollectionMessage(`Selamat! Kamu mendapatkan ${unlockedAnimal.name}!`);
            } else {
                showCollectionMessage("Koleksimu sudah penuh! Hebat!");
            }
        }

        /**
         * Memperbarui tampilan koleksi hewan.
         */
        function updateCollectionDisplay() {
            animalCollectionDiv.innerHTML = ''; // Hapus tampilan lama
            animalList.forEach(animal => {
                const animalElement = document.createElement('div');
                animalElement.className = 'text-center';
                const emoji = animal.unlocked ? `<span class="text-4xl md:text-5xl">${animal.emoji}</span>` : `<span class="text-4xl md:text-5xl opacity-30">‚ùì</span>`;
                const text = animal.unlocked ? `<p class="mt-1 text-sm text-gray-700">${animal.name}</p>` : `<p class="mt-1 text-sm text-gray-400">Terkunci</p>`;
                animalElement.innerHTML = `${emoji}${text}`;
                animalCollectionDiv.appendChild(animalElement);
            });
        }

        /**
         * Menampilkan pesan feedback kepada pengguna.
         * @param {string} message - Pesan yang akan ditampilkan.
         * @param {string} colorClass - Kelas warna Tailwind CSS (misalnya 'text-green-500').
         */
        function showFeedback(message, colorClass) {
            feedbackMessage.textContent = message;
            feedbackMessage.classList.add('opacity-100', colorClass);
        }

        /**
         * Menampilkan pesan di area koleksi.
         * @param {string} message - Pesan yang akan ditampilkan.
         */
        function showCollectionMessage(message) {
            collectionMessage.textContent = message;
            collectionMessage.classList.add('opacity-100');
            setTimeout(() => {
                collectionMessage.classList.remove('opacity-100');
            }, 3000);
        }

        /**
         * Memperbarui tampilan skor dan level.
         */
        function updateUI() {
            scoreElement.textContent = score;
            levelElement.textContent = level;
        }

        // Menambahkan event listener ke tombol "Cek"
        submitBtn.addEventListener('click', checkAnswer);

        // Menambahkan event listener untuk tombol 'Enter' pada input
        answerInput.addEventListener('keydown', (event) => {
            if (event.key === 'Enter') {
                event.preventDefault();
                checkAnswer();
            }
        });

        // Memulai permainan saat halaman dimuat
        generateProblem();
        updateCollectionDisplay(); // Tampilkan koleksi kosong di awal
    </script>
</body>
</html>
